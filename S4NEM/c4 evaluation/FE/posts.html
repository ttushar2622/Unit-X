<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notes</title>
</head>

<body>
    <h1>Notes</h1>
    <button id="topcmnt" onclick="showtop()">show to top commented post</button>

   

    <div id="notebox">
        


    </div>
    <a href="./index.html">go to register page</a>
    <a href="./login.html">go to log in page</a>
    <a href="./addposts.html">go to create note</a>


</body>

</html>
<script>
    
    const getData = () => {
        fetch("http://localhost:3399/posts", {
            method: "GET",

            headers: {
                "Authorization": localStorage.getItem("token")
            }

        })
            .then((res) => {
                return res.json();
            })
            .then((res) => {
                console.log(res)
                Display(res)
            })
            .catch((err) => { console.log(err); })
    }




    const showtop=()=>{
        fetch("http://localhost:3399/posts/top", {
            method: "GET",

            headers: {
                "Authorization": localStorage.getItem("token")
            }

        })
            .then((res) => {
                return res.json();
            })
            .then((data) => {
                console.log(data)
                Display(data)
            })
            .catch((err) => { console.log(err); })
    }

//     const deletePosts = (postid) => {
//   fetch(`http://localhost:3399/posts/delete/${postid}`, {
//     method: 'DELETE'
//   })
//   .then(response => {
//     if (response.ok) {
//         // alert("deleted")
//       console.log(response)
//     //   window.location="./posts.html";
   
    
            

//     } else {
      
//       console.log(`Failed to delete resource with ID ${postid}: ${response.statusText}`);
//     }
//   })
//   .catch(error => {
//     console.log(`Error deleting resource with ID ${postid}: ${error}`);
//   });
// };
    // let api=("http://localhost:9898/notes")
    //     fectheddata()
    //     async function fectheddata(){
    //         try{
    //             let res=await  fetch(api,{

    //   headers:{
    //       "Authorization":localStorage.getItem("token")
    //   }

    // })
    //             let data= await res.json()
    //             console.log(data);
    //             Display(data)
    //         }catch(err){
    //             console.log(err)
    //         }
    //     }
    // }


    getData()
    showtop()
    let notebox = document.getElementById("notebox")
    function Display(res) {
        notebox.innerHTML = null;
        res.forEach((element) => {
            let postid = document.createElement("h1");
            postid.setAttribute("id", "postid")
            postid.innerText = element._id

            let title = document.createElement("h1");
            title.setAttribute("id", "title")
            title.innerText = element.title

            let body = document.createElement("p");
            body.setAttribute("id", "body")
            body.innerText = element.body

            let device = document.createElement("p");
            device.setAttribute("id", "device")
            device.innerText = element.device

            let no_of_comments = document.createElement("p");
            no_of_comments.setAttribute("id", "no_of_comments")
            no_of_comments.innerText = element.no_of_comments

            let id = document.createElement("p");
            id.setAttribute("id", "id")
            id.innerText = element.userID

            let deleteButton = document.createElement("button");
            deleteButton.setAttribute("id", "delete");
            deleteButton.innerText = "DELETE";


            let updateButton = document.createElement("button");
            updateButton.setAttribute("id", "delete");
            updateButton.innerText = "UPDATE";


            
           

               
            




            notebox.append(postid,title, body, device,no_of_comments, id, deleteButton)
        })
    }


    
  

//     const deleteNote = (element.id) => {
   
//     fetch(`http://localhost:9898/notes/delete/${noteId}`, {
//       method: 'DELETE',
//       headers: {
//         'Authorization': localStorage.getItem("token")
//       }
//     })
//     .then(res => {
//       if (!res.ok) {
//         throw new Error('Network res was not ok');
//       }
//       return res.json();
//     })
//     .then(data => {
//       console.log(data); // log success message from server
//       // do something with the res data if needed
//       Display(data)
//     })
//     .catch(error => {
//       console.error('There was a problem with the fetch operation:', error);
//     });
//   };

</script>



